<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<AnchorPane prefWidth="460.0" prefHeight="600.0" minWidth="420.0" minHeight="580.0" styleClass="root" xmlns="http://javafx.com/javafx/8.0.40"
            xmlns:fx="http://javafx.com/fxml/1" fx:controller="acmi.l2.clientmod.l2tool.Controller">
    
    <!-- Title Bar -->
    <HBox fx:id="titleBar" alignment="CENTER_LEFT" spacing="8.0" prefHeight="32.0" styleClass="title-bar"
          AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
        <padding><Insets left="10"/></padding>
        <ImageView fitHeight="18.0" fitWidth="18.0" pickOnBounds="true" preserveRatio="true">
            <image><Image url="@L2Tool.png"/></image>
        </ImageView>
        <Label text="L2Tool" styleClass="title-label"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button fx:id="minimizeBtn" mnemonicParsing="false" onAction="#minimizeWindow" 
                styleClass="window-button" text="─"/>
        <Button fx:id="closeBtn" mnemonicParsing="false" onAction="#closeWindow" 
                styleClass="window-button, close-button" text="✕"/>
    </HBox>
    
    <!-- Main Content wrapped in ScrollPane -->
    <ScrollPane fitToWidth="true" hbarPolicy="NEVER" styleClass="scroll-pane"
                AnchorPane.topAnchor="40.0" AnchorPane.bottomAnchor="0.0" 
                AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">
        <VBox spacing="6.0" style="-fx-background-color: transparent;">
            <padding><Insets top="5" right="12" bottom="5" left="12"/></padding>
            
            <!-- Package Section -->
            <VBox styleClass="card" spacing="8.0">
                <Label text="PACKAGE" styleClass="section-header"/>
                <HBox spacing="6.0" alignment="CENTER_LEFT">
                    <TextField fx:id="utxPath" editable="false" promptText="Select a .utx file..." HBox.hgrow="ALWAYS"/>
                    <Button mnemonicParsing="false" onAction="#selectPackage" styleClass="button">
                        <graphic><Region styleClass="icon-browse"/></graphic>
                        <tooltip><Tooltip text="Browse .utx pack"/></tooltip>
                    </Button>
                    <Button fx:id="toUED" mnemonicParsing="false" onAction="#convertUTX" text="→ UED" styleClass="button"/>
                </HBox>
            </VBox>
            
            <!-- Texture Section -->
            <VBox styleClass="card" spacing="10.0">
                <Label text="TEXTURE" styleClass="section-header"/>
                <HBox spacing="6.0" alignment="CENTER_LEFT">
                    <ComboBox fx:id="textureList" promptText="Select texture..." HBox.hgrow="ALWAYS" maxWidth="1.7976931348623157E308"/>
                </HBox>
                <HBox spacing="8.0" alignment="CENTER_LEFT">
                    <Button fx:id="textureInfo" mnemonicParsing="false" onAction="#showTextureInfo" text="Info" styleClass="button">
                        <graphic><Region styleClass="icon-info"/></graphic>
                    </Button>
                    <Button fx:id="view" mnemonicParsing="false" onAction="#showTexture" text="View" styleClass="button">
                        <graphic><Region styleClass="icon-view"/></graphic>
                    </Button>
                    <Button fx:id="export" mnemonicParsing="false" onAction="#exportTexture" text="Export" styleClass="button">
                        <graphic><Region styleClass="icon-export"/></graphic>
                    </Button>
                </HBox>
            </VBox>
            
            <!-- Batch Export Section -->
            <VBox styleClass="card" spacing="12.0">
                <Label text="BATCH EXPORT" styleClass="section-header"/>
                
                <Label text="Format:" styleClass="label-bright"/>
                <FlowPane hgap="12.0" vgap="8.0">
                    <RadioButton fx:id="formatPNG" selected="true" text="PNG"/>
                    <RadioButton fx:id="formatJPEG" text="JPEG"/>
                    <RadioButton fx:id="formatBMP" text="BMP"/>
                    <RadioButton fx:id="formatGIF" text="GIF"/>
                    <RadioButton fx:id="formatWEBP" text="WEBP"/>
                    <RadioButton fx:id="formatDDS" text="DDS"/>
                </FlowPane>
                
                <Separator/>
                
                <VBox spacing="8.0">
                    <CheckBox fx:id="keepStructure" selected="true" text="Keep folder structure"/>
                    <CheckBox fx:id="clearOutput" selected="false" text="Clear output folder"/>
                </VBox>
                
                <Button fx:id="exportAll" maxWidth="1.7976931348623157E308" mnemonicParsing="false" 
                        onAction="#exportAllTextures" text="Export All Textures" styleClass="button-primary">
                    <graphic><Region styleClass="icon-export" style="-fx-background-color: white;"/></graphic>
                </Button>
            </VBox>
            
            <!-- Replace Texture Section -->
            <VBox styleClass="card" spacing="8.0">
                <Label text="REPLACE TEXTURE" styleClass="section-header"/>
                <HBox spacing="6.0" alignment="CENTER_LEFT">
                    <TextField fx:id="imgPath" editable="false" promptText="Select image to import..." HBox.hgrow="ALWAYS"/>
                    <Button mnemonicParsing="false" onAction="#selectImage" styleClass="button">
                         <graphic><Region styleClass="icon-browse"/></graphic>
                    </Button>
                </HBox>
                <Button fx:id="set" maxWidth="1.7976931348623157E308" mnemonicParsing="false" 
                        onAction="#replaceTexture" text="Replace Selected Texture" styleClass="button-primary">
                    <graphic><Region styleClass="icon-replace"/></graphic>
                </Button>
            </VBox>
        </VBox>
    </ScrollPane>
    
    <!-- Progress Indicator Overlay -->
    <ProgressIndicator fx:id="progress" visible="false" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0"
                       AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0"/>
</AnchorPane>
